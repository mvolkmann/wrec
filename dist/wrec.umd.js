(function(p,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(p=typeof globalThis<"u"?globalThis:p||self,d(p.wrec={}))})(this,(function(p){"use strict";function d(n,t){let e=n;for(const s of t.split("."))e=e[s];return e}function H(n,t,e){const s=t.split("."),o=s.length-1;let i=n;s.forEach((r,h)=>{h===o?i[r]=e:i=i[r]})}class b extends Error{}const j=/([a-zA-Z-]+)\s*:\s*([^;}]+)/g,P="a-zA-Z_$",F=P+"0-9",y=`[${P}][${F}]*`,V=/<!--\s*(.*?)\s*-->/,_=/<(\w+)(?:\s[^>]*)?>((?:[^<]|<(?!\w))*?)<\/\1>/g,E=new RegExp(`^this\\.${y}$`),C=new RegExp(`this\\.${y}(\\.${y})*`,"g"),$=new RegExp(`this\\.${y}(\\.${y})*`),I=new Set(["class","style"]),N=5;function D(n){return n instanceof HTMLButtonElement||n instanceof HTMLFieldSetElement||n instanceof HTMLInputElement||n instanceof HTMLSelectElement||n instanceof HTMLTextAreaElement||n instanceof l}function B(n){const t=new CSSStyleSheet;for(const e of Array.from(n.cssRules))t.insertRule(e.cssText);return t}function q(n,t,e){const s=document.createElement(n);if(t)for(const[o,i]of Object.entries(t))s.setAttribute(o,i);return e&&(s.innerHTML=e),s}const z=n=>n===String?"":n===Number?0:n===Boolean?!1:n===Array?[]:n===Object?{}:void 0;function T(n){const t=[];let e=n.firstElementChild;for(;e;)t.push(e),e.shadowRoot&&t.push(...T(e.shadowRoot)),e.firstElementChild&&t.push(...T(e)),e=e.nextElementSibling;return t}const S=n=>n.substring(N).split(".")[0];function x(n,t){let e=n[0];return t.forEach((s,o)=>{e+=s+n[o+1]}),e}function w(n){const t=typeof n;return t==="string"||t==="number"||t==="boolean"}function g(n){return n.localName==="textarea"}function R(n){const{localName:t}=n;return t==="input"||t==="select"}const Z=n=>n.replace(/<!--[\s\S]*?-->/g,"");function L(n,t,e,s){return n.slice(0,t)+s+n.slice(t+e)}function v(n){const t=Number(n);if(isNaN(t))throw new b(`can't convert "${n}" to a number`);return t}function O(n,t,e){const[s,o]=t.split(":");if(w(e))if(typeof e=="boolean"){e?n.setAttribute(s,s):n.removeAttribute(s);const i=l.getPropName(s);n[i]=e}else{const i=n.getAttribute(t),r=String(e);i!==r&&(n.setAttribute(s,r),s==="value"&&R(n)&&(n.value=r))}else{const i=l.getPropName(t);n[i]=e}}function M(n,t,e){const[s,o]=t.split(":");n instanceof CSSStyleRule?n.style.setProperty(s,e):(O(n,s,e),s==="value"&&R(n)&&(n.value=e))}class l extends HTMLElement{static#p=new Map;static#d=new Map;static css="";static formAssociated=!1;static html="";static properties;static propToComputedMap;static propToExprsMap;static stylesheet=null;static template=null;#t=this.constructor;#s=new Map;#a={};#i;#f={};#h=null;#l=new Map;constructor(){super(),this.attachShadow({mode:"open"});const t=this.#t;t.properties||(t.properties={}),t.propToComputedMap||(t.propToComputedMap=new Map),t.propToExprsMap||(t.propToExprsMap=new Map)}attributeChangedCallback(t,e,s){t==="disabled"&&this.#m();const o=l.getPropName(t);if(this.#r(o)){const i=this.#A(o,String(s));this[o]=i;const r=this.#a[o];r&&this.setFormValue(r,String(i)),this.propertyChangedCallback(o,e,s)}}#T(){if(!this.shadowRoot)return;const t=this.#t;if(t.css){let{stylesheet:s}=t;if(!s){s=t.stylesheet=new CSSStyleSheet;const o=`:host([hidden]) { display: none; } ${t.css}`;s.replaceSync(o)}this.shadowRoot.adoptedStyleSheets=[B(s)]}let e=t.template;if(!e){e=t.template=document.createElement("template");const s=t.html.trim();e.innerHTML=s.startsWith("<")?s:`<span><!--${s}--></span>`}this.shadowRoot.replaceChildren(e.content.cloneNode(!0))}changed(t,e,s){this[e]=s}connectedCallback(){this.#H(),this.#R(),this.#T(),this.hasAttribute("disabled")&&this.#m(),requestAnimationFrame(()=>{if(this.shadowRoot){this.#C(this.shadowRoot),this.#b(this.shadowRoot);for(const t of this.shadowRoot.adoptedStyleSheets)this.#N(t)}this.#w()})}#w(){const t=this.#t,{properties:e}=t;for(const[s,{computed:o}]of Object.entries(e))o&&(this[s]=this.#o(o))}#R(){const t=this.#t,{observedAttributes:e,properties:s}=t;for(const[o,i]of Object.entries(s))this.#v(o,i,e)}#v(t,e,s){const o=l.getAttrName(t),i=this.hasAttribute(o);e.required&&!i&&this.#e(this,t,"is a required attribute");let r=e.value;this.hasOwnProperty(t)&&(r=this[t],delete this[t]);const{type:h}=e,c=h===Boolean?r||i:s.includes(o)&&i?this.#S(t,o):r||z(h),f="#"+t;this[f]=c,e.computed&&this.#x(t,e),Object.defineProperty(this,t,{enumerable:!0,get(){return this[f]},set(a){h===Number&&typeof a=="string"&&(a=v(a));const u=this[f];if(a===u)return;this.#F(t,h,a),this[f]=a;const{state:m,stateProp:A}=this.#t.properties[t];A&&H(m,A,a),this.#O(t),this.#L(t,h,a,o),this.#g(t),this.#k(t,a);const k=this.#a[t];k&&this.setFormValue(k,String(a)),this.propertyChangedCallback(t,u,a),e.dispatch&&this.dispatch("change",{[t]:a})}})}#m(){const t=this.hasAttribute("disabled"),e=T(this.shadowRoot);for(const s of e)D(s)&&(s.disabled=t)}disconnectedCallback(){this.#s.clear(),this.#f.clear(),this.#l.clear()}dispatch(t,e){this.dispatchEvent(new CustomEvent(t,{bubbles:!0,composed:!0,detail:e}))}displayIfSet(t,e="block"){return`display: ${t?e:"none"}`}static elementName(){return this.name.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}#M(t){const e=t instanceof l;for(const s of t.getAttributeNames()){const o=t.getAttribute(s),i=this.#y(t,o);if(i){const r=this[i];r===void 0&&this.#c(t,s,i),t[i]=r;let[h,c]=s.split(":");h==="value"&&(c?(t["on"+c]===void 0&&this.#e(t,s,"refers to an unsupported event name"),t.setAttribute(h,this[i])):c="change"),e&&t.#l.set(l.getPropName(h),i)}this.#n(o,t,s)}}#o(t){const e=new Function("return "+t).call(this);return Array.isArray(e)?e.join(""):e}#P(t){const{localName:e}=t;if(e==="style"){const{sheet:s}=t,o=s?.cssRules??[],i=Array.from(o);for(const r of i)if(r.constructor===CSSStyleRule){const h=Array.from(r.style);for(const c of h)if(c.startsWith("--")){const f=r.style.getPropertyValue(c);this.#n(f,r,c)}}}else{let s="";if(g(t)){this.#n(t.textContent,t);const o=t.textContent?.match(V);o&&(s=o[1])}else{const o=Array.from(t.childNodes).find(i=>i.nodeType===Node.COMMENT_NODE);o&&(s=o.textContent?.trim()??"")}if(s){const o=this.#y(t,s);o&&g(t)?t.textContent=this[o]:this.#n(s,t)}}}formAssociatedCallback(){let t=this.getAttribute("form-assoc");if(!t){const r=this.getAttribute("name");if(r)if(this.#r("value"))t=`value:${r}`;else return;else return}const e={},s=t.split(",");for(const r of s){const[h,c]=r.split(":");e[h.trim()]=c.trim()}this.#a=e,this.#i=new FormData,this.#h=this.attachInternals(),this.#h.setFormValue(this.#i);const o=Object.keys(this.#t.properties),i=this.#f;for(const r of o)i[r]=this[r]}formResetCallback(){const t=this.#f;for(const e of Object.keys(t)){let s=t[e];E.test(s)&&(s=this.#o(s)),this[e]=s}}static getAttrName(t){let e=l.#d.get(t);return e||(e=t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l.#d.set(t,e)),e}static getPropName(t){let e=l.#p.get(t);return e||(e=t.replace(/-([a-z])/g,(s,o)=>o.toUpperCase()),l.#p.set(t,e)),e}#$(t,e,s){if(s.length!==1)return;const[o]=s;if(!E.test(o))return;const i=R(t)||g(t);let[r,h]=(e??"").split(":");if(!(i&&r==="value"||g(t)))return;h?t["on"+h]===void 0&&this.#e(t,e,"refers to an unsupported event name"):h="change";const f=S(o);t.addEventListener(h,a=>{const{target:u}=a;if(!u)return;const m=u.value,{type:A}=this.#t.properties[f];this[f]=A===Number?v(m):m,this.#g(f)})}#r(t){return!!this.#t.properties[t]}#b(t){const e=Array.from(t.querySelectorAll("*"));for(const s of e)this.#M(s),s.firstElementChild||this.#P(s)}#N(t){const e=t.cssRules;for(const s of Array.from(e))if(s instanceof CSSStyleRule){for(const o of Array.from(s.style))if(o.startsWith("--")){const i=s.style.getPropertyValue(o);this.#n(i,s,o)}}}static get observedAttributes(){const t=Object.keys(this.properties||{}).map(l.getAttrName);return t.includes("disabled")||t.push("disabled"),t}propertyChangedCallback(t,e,s){}#y(t,e){if(!e||!E.test(e))return;const s=S(e);return this[s]===void 0&&this.#c(t,"",s),s}#g(t){const o=this.#t.propToExprsMap.get(t)||[];for(const i of o){let r=this.#o(i);const h=this.#s.get(i)??[];for(const c of h)if(c instanceof HTMLElement)this.#E(c,r);else if(!(c instanceof CSSStyleRule)){const{element:f,attrName:a}=c;f instanceof CSSStyleRule?f.style.setProperty(a,r):M(f,a,r)}}}static register(){const t=this.elementName();customElements.get(t)||customElements.define(t,this)}#x(t,e){const{computed:s,uses:o}=e,i=this.#t.propToComputedMap;function r(c,f){let a=i.get(c);a||(a=[],i.set(c,a)),a.push([t,f])}const h=s.match(C)||[];for(const c of h){const f=c.substring(N);this[f]===void 0&&this.#c(null,t,f),typeof this[f]!="function"&&r(f,s)}if(o)for(const c of o.split(","))r(c,s)}#n(t,e,s=void 0){if(!t)return;const o=this.#u(e,s,t);if(!o){const c=t.replaceAll("this..","this.");s?M(e,s,c):"textContent"in e&&(e.textContent=c);return}const i=this.#t;o.forEach(c=>{const f=S(c);if(typeof this[f]=="function")return;const a=i.propToExprsMap;let u=a.get(f);u||(u=[],a.set(f,u)),u.includes(t)||u.push(t)});for(const[c,f]of this.#s.entries())for(const a of f){const u=a instanceof HTMLElement||a instanceof CSSStyleRule?a:a.element;u instanceof CSSStyleRule||u.isConnected||this.#s.set(c,f.filter(m=>m!==a))}let r=this.#s.get(t);r||(r=[],this.#s.set(t,r)),r.push(s?{element:e,attrName:s}:e),e instanceof HTMLElement&&this.#$(e,s,o);const h=this.#o(t);s?M(e,s,h):this.#E(e,h)}setAttributeSafe(t,e){this.hasAttribute(t)||this.setAttribute(t,e)}setFormValue(t,e){!this.#i||!w(e)||(this.#i.set(t,e),this.#h?.setFormValue(this.#i))}#e(t,e,s){const o=this.#t,i=t instanceof HTMLElement?t.localName:"CSS rule";throw new b(`component ${o.elementName()}`+(t?`, element "${i}"`:"")+(e?`, attribute "${e}"`:"")+` ${s}`)}#c(t,e,s){this.#e(t,e,`refers to missing property "${s}"`)}#S(t,e){return this.#A(t,this.getAttribute(e))}#A(t,e){if(e?.match(C))return e;const s=this.#t,{type:o}=s.properties[t];if(o||this.#e(null,t,"does not specify its type"),o===String)return e;if(o===Number)return v(e);if(o===Boolean)return e==="true"?!0:e==="false"||e==="null"?!1:(e&&e!==t&&this.#e(null,t,"is a Boolean attribute, so its value must match attribute name or be missing"),e===t)}#L(t,e,s,o){if(w(s)&&this.hasAttribute(o)){const i=e===Boolean?this.hasAttribute(o):this.#S(t,o);s!==i&&O(this,t,s)}}#O(t){const s=this.#t.propToComputedMap.get(t)||[];for(const[o,i]of s)this[o]=this.#o(i)}#E(t,e){if(e===void 0)return;const s=t instanceof HTMLElement,o=typeof e;o!=="string"&&o!=="number"&&this.#e(t,void 0," computed content is not a string or number"),t instanceof HTMLElement&&g(t)?t.value=e:s&&o==="string"&&e.trim().startsWith("<")?(t.innerHTML=e,this.#C(t),this.#b(t)):s&&(t.textContent=e)}#k(t,e){const s=this.#l.get(t);if(!s)return;const o=this.getRootNode();if(!(o instanceof ShadowRoot))return;const{host:i}=o;if(!i)return;const r=i;r[s]=e}useState(t,e){if(!e){e={};for(const s of Object.keys(t))e[s]=s}this.#j(t,e);for(const[s,o]of Object.entries(e))if(this.#r(o)){const i=d(t,s);i!==void 0&&(this[o]=i);const r=this.#t.properties[o];r.state=t,r.stateProp=s}t.addListener(this,e)}#H(){const t=this.#t,e=new Set(Object.keys(t.properties));for(const o of e)I.has(o)&&this.#e(null,"",`property "${o}" is not allowed because it is a reserved attribute`);const s=this.#t.name;for(const o of this.getAttributeNames())if(o!=="class"&&o!=="id"&&o!=="disabled"&&!o.startsWith("on")){if(o==="form-assoc"){if(!t.formAssociated)throw new b(`add "static formAssociated = true;" to class ${s}`);continue}if(!e.has(l.getPropName(o))){if(o==="name"){if(t.formAssociated)continue;throw new b(`name attribute requires "static formAssociated = true;" in class ${s}`)}this.#e(null,o,"is not a supported attribute")}}}#u(t,e,s){const o=s.match(C);if(o)return o.forEach(i=>{const r=S(i);this[r]===void 0&&this.#c(t,e,r)}),o}#j(t,e){for(const[s,o]of Object.entries(e)){let i=d(t,s);if(i===void 0)throw new b(`invalid state path "${s}"`);i=this[o],this.#r(o)||this.#e(null,o,"refers to missing property in useState map")}}#F(t,e,s){if(s instanceof e)return;let o=typeof s;if(o==="object"){const{constructor:i}=s;o=i.name,i!==e&&this.#e(null,t,`was set to a ${o}, but must be a ${e.name}`)}o!==e.name.toLowerCase()&&this.#e(null,t,`was set to a ${o}, but must be a ${e.name}`)}#C(t){const e=Array.from(t.querySelectorAll("*"));for(const s of e){const o=[];for(const i of Array.from(s.attributes)){const r=i.name;if(r.startsWith("on")){let h=r.slice(2);h=h[0].toLowerCase()+h.slice(1).toLowerCase();const c=i.value;this.#u(s,r,c);let f;typeof this[c]=="function"?f=a=>this[c](a):(this.#u(s,r,c),f=()=>this.#o(c)),s.addEventListener(h,f),o.push(r)}}for(const i of o)s.removeAttribute(i)}}}function K(n,...t){let e=x(n,t);for(;;){const s=j.exec(e);if(!s)break;const o=s[2];if($.test(o)){const i=s[1];if(!i.startsWith("--")){const r=`--${i}: ${o};
      ${i}: var(--${i})`;e=L(e,s.index,s[0].length,r)}}}return e}function X(n,...t){let e=x(n,t);for(;;){const s=_.exec(e);if(!s||s[1]==="style")break;const o=Z(s[2]);if($.test(o)){const i=`<!-- ${o.trim()} -->`,r=s.index+s[0].indexOf(">")+1;e=L(e,r,o.length,i)}}return e}p.Wrec=l,p.createElement=q,p.css=K,p.html=X,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})}));
