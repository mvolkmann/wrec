(function(p,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(p=typeof globalThis<"u"?globalThis:p||self,d(p.wrec={}))})(this,(function(p){"use strict";function d(r,t){let e=r;for(const s of t.split("."))e=e[s];return e}function k(r,t,e){const s=t.split("."),i=s.length-1;let o=r;s.forEach((n,h)=>{h===i?o[n]=e:o=o[n]})}class b extends Error{}const j=/([a-zA-Z-]+)\s*:\s*([^;}]+)/g,P="a-zA-Z_$",F=P+"0-9",g=`[${P}][${F}]*`,_=/<!--\s*(.*?)\s*-->/,V=/<(\w+)(?:\s[^>]*)?>((?:[^<]|<(?!\w))*?)<\/\1>/g,T=new RegExp(`^this\\.${g}$`),C=new RegExp(`this\\.${g}(\\.${g})*`,"g"),N=new RegExp(`this\\.${g}(\\.${g})*`),I=new Set(["class","style"]),$=5;function D(r){return r instanceof HTMLButtonElement||r instanceof HTMLFieldSetElement||r instanceof HTMLInputElement||r instanceof HTMLSelectElement||r instanceof HTMLTextAreaElement||r instanceof u}function B(r,t,e){const s=document.createElement(r);if(t)for(const[i,o]of Object.entries(t))s.setAttribute(i,o);return e&&(s.innerHTML=e),s}const q=r=>r===String?"":r===Number?0:r===Boolean?!1:r===Array?[]:r===Object?{}:void 0;function w(r){const t=[];let e=r.firstElementChild;for(;e;)t.push(e),e.shadowRoot&&t.push(...w(e.shadowRoot)),e.firstElementChild&&t.push(...w(e)),e=e.nextElementSibling;return t}const y=r=>r.substring($).split(".")[0];function x(r,t){let e=r[0];return t.forEach((s,i)=>{e+=s+r[i+1]}),e}function S(r){const t=typeof r;return t==="string"||t==="number"||t==="boolean"}function E(r){return r.localName==="textarea"}function v(r){const{localName:t}=r;return t==="input"||t==="select"}const z=r=>r.replace(/<!--[\s\S]*?-->/g,"");function L(r,t,e,s){return r.slice(0,t)+s+r.slice(t+e)}function M(r){const t=Number(r);if(isNaN(t))throw new b(`can't convert "${r}" to a number`);return t}function O(r,t,e){const[s,i]=t.split(":");if(S(e))if(typeof e=="boolean"){e?r.setAttribute(s,s):r.removeAttribute(s);const o=u.getPropName(s);r[o]=e}else{const o=r.getAttribute(t),n=String(e);o!==n&&(r.setAttribute(s,n),s==="value"&&v(r)&&(r.value=n))}else{const o=u.getPropName(t);r[o]=e}}function R(r,t,e){const[s,i]=t.split(":");r instanceof CSSStyleRule?r.style.setProperty(s,e):(O(r,s,e),s==="value"&&v(r)&&(r.value=e))}class u extends HTMLElement{static#p=new Map;static#d=new Map;static css="";static formAssociated=!1;static html="";static properties;static propToComputedMap;static propToExprsMap;static template=null;#t=this.constructor;#s=new Map;#a={};#o;#f={};#h=null;#u=new Map;constructor(){super(),this.attachShadow({mode:"open"});const t=this.#t;t.properties||(t.properties={}),t.propToComputedMap||(t.propToComputedMap=new Map),t.propToExprsMap||(t.propToExprsMap=new Map)}attributeChangedCallback(t,e,s){t==="disabled"&&this.#m();const i=u.getPropName(t);if(this.#n(i)){const o=this.#A(i,String(s));this[i]=o;const n=this.#a[i];n&&this.setFormValue(n,String(o)),this.propertyChangedCallback(i,e,s)}}#w(){if(!this.shadowRoot)return;const t=this.#t;let{template:e}=t;if(!e){e=t.template=document.createElement("template");let s=`<style>
    :host([hidden]) { display: none; }`;t.css&&(s+=t.css),s+=`</style>
`;let i=t.html.trim();i.startsWith("<")||(i=`<span><!--${i}--></span>`),e.innerHTML=s+i}this.shadowRoot.replaceChildren(e.content.cloneNode(!0))}changed(t,e,s){this[e]=s}connectedCallback(){this.#H(),this.#v(),this.#w(),this.hasAttribute("disabled")&&this.#m(),requestAnimationFrame(()=>{this.shadowRoot&&(this.#C(this.shadowRoot),this.#b(this.shadowRoot)),this.#S()})}#S(){const t=this.#t,{properties:e}=t;for(const[s,{computed:i}]of Object.entries(e))i&&(this[s]=this.#i(i))}#v(){const t=this.#t,{observedAttributes:e,properties:s}=t;for(const[i,o]of Object.entries(s))this.#M(i,o,e)}#M(t,e,s){const i=u.getAttrName(t),o=this.hasAttribute(i);e.required&&!o&&this.#e(this,t,"is a required attribute");let n=e.value;this.hasOwnProperty(t)&&(n=this[t],delete this[t]);const{type:h}=e,c=h===Boolean?n||o:s.includes(i)&&o?this.#y(t,i):n||q(h),f="#"+t;this[f]=c,e.computed&&this.#$(t,e),Object.defineProperty(this,t,{enumerable:!0,get(){return this[f]},set(a){h===Number&&typeof a=="string"&&(a=M(a));const l=this[f];if(a===l)return;this.#j(t,h,a),this[f]=a;const{state:m,stateProp:A}=this.#t.properties[t];A&&k(m,A,a),this.#L(t),this.#x(t,h,a,i),this.#E(t),this.#O(t,a);const H=this.#a[t];H&&this.setFormValue(H,String(a)),this.propertyChangedCallback(t,l,a),e.dispatch&&this.dispatch("change",{[t]:a})}})}#m(){const t=this.hasAttribute("disabled"),e=w(this.shadowRoot);for(const s of e)D(s)&&(s.disabled=t)}disconnectedCallback(){this.#s.clear(),this.#f.clear(),this.#u.clear()}dispatch(t,e){this.dispatchEvent(new CustomEvent(t,{bubbles:!0,composed:!0,detail:e}))}displayIfSet(t,e="block"){return`display: ${t?e:"none"}`}static elementName(){return this.name.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}#R(t){const e=t instanceof u;for(const s of t.getAttributeNames()){const i=t.getAttribute(s),o=this.#g(t,i);if(o){const n=this[o];n===void 0&&this.#c(t,s,o),t[o]=n;let[h,c]=s.split(":");h==="value"&&(c?(t["on"+c]===void 0&&this.#e(t,s,"refers to an unsupported event name"),t.setAttribute(h,this[o])):c="change"),e&&t.#u.set(u.getPropName(h),o)}this.#r(i,t,s)}}#i(t){const e=new Function("return "+t).call(this);return Array.isArray(e)?e.join(""):e}#P(t){const{localName:e}=t;if(e==="style"){const{sheet:s}=t,i=s?.cssRules??[],o=Array.from(i);for(const n of o)if(n.constructor===CSSStyleRule){const h=Array.from(n.style);for(const c of h)if(c.startsWith("--")){const f=n.style.getPropertyValue(c);this.#r(f,n,c)}}}else{let s="";if(E(t)){this.#r(t.textContent,t);const i=t.textContent?.match(_);i&&(s=i[1])}else{const i=Array.from(t.childNodes).find(o=>o.nodeType===Node.COMMENT_NODE);i&&(s=i.textContent?.trim()??"")}if(s){const i=this.#g(t,s);i&&E(t)?t.textContent=this[i]:this.#r(s,t)}}}formAssociatedCallback(){let t=this.getAttribute("form-assoc");if(!t){const n=this.getAttribute("name");if(n)if(this.#n("value"))t=`value:${n}`;else return;else return}const e={},s=t.split(",");for(const n of s){const[h,c]=n.split(":");e[h.trim()]=c.trim()}this.#a=e,this.#o=new FormData,this.#h=this.attachInternals(),this.#h.setFormValue(this.#o);const i=Object.keys(this.#t.properties),o=this.#f;for(const n of i)o[n]=this[n]}formResetCallback(){const t=this.#f;for(const e of Object.keys(t)){let s=t[e];T.test(s)&&(s=this.#i(s)),this[e]=s}}static getAttrName(t){let e=u.#d.get(t);return e||(e=t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),u.#d.set(t,e)),e}static getPropName(t){let e=u.#p.get(t);return e||(e=t.replace(/-([a-z])/g,(s,i)=>i.toUpperCase()),u.#p.set(t,e)),e}#N(t,e,s){if(s.length!==1)return;const[i]=s;if(!T.test(i))return;const o=v(t)||E(t);let[n,h]=(e??"").split(":");if(!(o&&n==="value"||E(t)))return;h?t["on"+h]===void 0&&this.#e(t,e,"refers to an unsupported event name"):h="change";const f=y(i);t.addEventListener(h,a=>{const{target:l}=a;if(!l)return;const m=l.value,{type:A}=this.#t.properties[f];this[f]=A===Number?M(m):m,this.#E(f)})}#n(t){return!!this.#t.properties[t]}#b(t){const e=Array.from(t.querySelectorAll("*"));for(const s of e)this.#R(s),s.firstElementChild||this.#P(s)}static get observedAttributes(){const t=Object.keys(this.properties||{}).map(u.getAttrName);return t.includes("disabled")||t.push("disabled"),t}propertyChangedCallback(t,e,s){}#g(t,e){if(!e||!T.test(e))return;const s=y(e);return this[s]===void 0&&this.#c(t,"",s),s}#E(t){const i=this.#t.propToExprsMap.get(t)||[];for(const o of i){let n=this.#i(o);const h=this.#s.get(o)??[];for(const c of h)if(c instanceof HTMLElement)this.#T(c,n);else if(!(c instanceof CSSStyleRule)){const{element:f,attrName:a}=c;f instanceof CSSStyleRule?f.style.setProperty(a,n):R(f,a,n)}}}static register(){const t=this.elementName();customElements.get(t)||customElements.define(t,this)}#$(t,e){const{computed:s,uses:i}=e,o=this.#t.propToComputedMap;function n(c,f){let a=o.get(c);a||(a=[],o.set(c,a)),a.push([t,f])}const h=s.match(C)||[];for(const c of h){const f=c.substring($);this[f]===void 0&&this.#c(null,t,f),typeof this[f]!="function"&&n(f,s)}if(i)for(const c of i.split(","))n(c,s)}#r(t,e,s=void 0){if(!t)return;const i=this.#l(e,s,t);if(!i){const c=t.replaceAll("this..","this.");s?R(e,s,c):"textContent"in e&&(e.textContent=c);return}const o=this.#t;i.forEach(c=>{const f=y(c);if(typeof this[f]=="function")return;const a=o.propToExprsMap;let l=a.get(f);l||(l=[],a.set(f,l)),l.includes(t)||l.push(t)});for(const[c,f]of this.#s.entries())for(const a of f){const l=a instanceof HTMLElement||a instanceof CSSStyleRule?a:a.element;l instanceof CSSStyleRule||l.isConnected||this.#s.set(c,f.filter(m=>m!==a))}let n=this.#s.get(t);n||(n=[],this.#s.set(t,n)),n.push(s?{element:e,attrName:s}:e),e instanceof HTMLElement&&this.#N(e,s,i);const h=this.#i(t);s?R(e,s,h):this.#T(e,h)}setAttributeSafe(t,e){this.hasAttribute(t)||this.setAttribute(t,e)}setFormValue(t,e){!this.#o||!S(e)||(this.#o.set(t,e),this.#h?.setFormValue(this.#o))}#e(t,e,s){const i=this.#t,o=t instanceof HTMLElement?t.localName:"CSS rule";throw new b(`component ${i.elementName()}`+(t?`, element "${o}"`:"")+(e?`, attribute "${e}"`:"")+` ${s}`)}#c(t,e,s){this.#e(t,e,`refers to missing property "${s}"`)}#y(t,e){return this.#A(t,this.getAttribute(e))}#A(t,e){if(e?.match(C))return e;const s=this.#t,{type:i}=s.properties[t];if(i||this.#e(null,t,"does not specify its type"),i===String)return e;if(i===Number)return M(e);if(i===Boolean)return e==="true"?!0:e==="false"||e==="null"?!1:(e&&e!==t&&this.#e(null,t,"is a Boolean attribute, so its value must match attribute name or be missing"),e===t)}#x(t,e,s,i){if(S(s)&&this.hasAttribute(i)){const o=e===Boolean?this.hasAttribute(i):this.#y(t,i);s!==o&&O(this,t,s)}}#L(t){const s=this.#t.propToComputedMap.get(t)||[];for(const[i,o]of s)this[i]=this.#i(o)}#T(t,e){if(e===void 0)return;const s=t instanceof HTMLElement,i=typeof e;i!=="string"&&i!=="number"&&this.#e(t,void 0," computed content is not a string or number"),t instanceof HTMLElement&&E(t)?t.value=e:s&&i==="string"&&e.trim().startsWith("<")?(t.innerHTML=e,this.#C(t),this.#b(t)):s&&(t.textContent=e)}#O(t,e){const s=this.#u.get(t);if(!s)return;const i=this.getRootNode();if(!(i instanceof ShadowRoot))return;const{host:o}=i;if(!o)return;const n=o;n[s]=e}useState(t,e){if(!e){e={};for(const s of Object.keys(t))e[s]=s}this.#k(t,e);for(const[s,i]of Object.entries(e))if(this.#n(i)){const o=d(t,s);o!==void 0&&(this[i]=o);const n=this.#t.properties[i];n.state=t,n.stateProp=s}t.addListener(this,e)}#H(){const t=this.#t,e=new Set(Object.keys(t.properties));for(const i of e)I.has(i)&&this.#e(null,"",`property "${i}" is not allowed because it is a reserved attribute`);const s=this.#t.name;for(const i of this.getAttributeNames())if(i!=="class"&&i!=="id"&&i!=="disabled"&&!i.startsWith("on")){if(i==="form-assoc"){if(!t.formAssociated)throw new b(`add "static formAssociated = true;" to class ${s}`);continue}if(!e.has(u.getPropName(i))){if(i==="name"){if(t.formAssociated)continue;throw new b(`name attribute requires "static formAssociated = true;" in class ${s}`)}this.#e(null,i,"is not a supported attribute")}}}#l(t,e,s){const i=s.match(C);if(i)return i.forEach(o=>{const n=y(o);this[n]===void 0&&this.#c(t,e,n)}),i}#k(t,e){for(const[s,i]of Object.entries(e)){let o=d(t,s);if(o===void 0)throw new b(`invalid state path "${s}"`);o=this[i],this.#n(i)||this.#e(null,i,"refers to missing property in useState map")}}#j(t,e,s){if(s instanceof e)return;let i=typeof s;if(i==="object"){const{constructor:o}=s;i=o.name,o!==e&&this.#e(null,t,`was set to a ${i}, but must be a ${e.name}`)}i!==e.name.toLowerCase()&&this.#e(null,t,`was set to a ${i}, but must be a ${e.name}`)}#C(t){const e=Array.from(t.querySelectorAll("*"));for(const s of e){const i=[];for(const o of Array.from(s.attributes)){const n=o.name;if(n.startsWith("on")){let h=n.slice(2);h=h[0].toLowerCase()+h.slice(1).toLowerCase();const c=o.value;this.#l(s,n,c);let f;typeof this[c]=="function"?f=a=>this[c](a):(this.#l(s,n,c),f=()=>this.#i(c)),s.addEventListener(h,f),i.push(n)}}for(const o of i)s.removeAttribute(o)}}}function Z(r,...t){let e=x(r,t);for(;;){const s=j.exec(e);if(!s)break;const i=s[2];if(N.test(i)){const o=s[1];if(!o.startsWith("--")){const n=`--${o}: ${i};
      ${o}: var(--${o})`;e=L(e,s.index,s[0].length,n)}}}return e}function K(r,...t){let e=x(r,t);for(;;){const s=V.exec(e);if(!s||s[1]==="style")break;const i=z(s[2]);if(N.test(i)){const o=`<!-- ${i.trim()} -->`,n=s.index+s[0].indexOf(">")+1;e=L(e,n,i.length,o)}}return e}p.Wrec=u,p.createElement=B,p.css=Z,p.html=K,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})}));
